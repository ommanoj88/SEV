# Deep Dive: Preventive Maintenance Alerts Analysis

**Date:** 2025-11-19
**Feature:** Preventive Maintenance Alerts
**Status:** ⚠️ **Client-Side Only / No Notifications**

This report analyzes the implementation of Preventive Maintenance Alerts.

## 1. Executive Summary
The "Alerts" feature is purely a **Client-Side Simulation**. The frontend fetches all maintenance records and calculates which ones are overdue in the browser. There is **no backend logic** to check for overdue maintenance, and consequently, **no ability to send Email or SMS notifications**. If a fleet manager doesn't log in to the dashboard, they will never know a vehicle is overdue.

## 2. Backend Analysis
**Status:** ❌ **Non-Existent**

*   **No Scheduled Tasks:**
    *   Search for `@Scheduled` returned 0 results.
    *   The server never wakes up to check "Is anything due today?".
*   **No Notification Service:**
    *   No integration with SendGrid, Twilio, or Firebase Cloud Messaging.
*   **No Alert Entity:**
    *   The database does not store "Alerts". It only stores "Maintenance Records".

## 3. Frontend Analysis (`MaintenanceAlertsCard.tsx`)
**Status:** ⚠️ **Heavy Client-Side Logic**

*   **Logic:**
    ```typescript
    // Fetches EVERYTHING
    const vehicles = await vehicleService.getVehiclesByCompany(companyId);
    const allSchedules = await maintenanceService.getAllSchedules();
    
    // Filters in Browser
    const upcomingAlerts = allSchedules.filter(...)
    ```
*   **Performance Risk:** As the fleet grows to 1000+ vehicles and 10,000+ records, this component will crash the browser (fetching all history to find 5 alerts).
*   **Business Logic Leak:** The definition of "High Priority" (Overdue) lives in the React component, not the server.

## 4. Impact
*   **Silent Failures:** If the dashboard isn't open, no one knows a truck is overdue for brakes.
*   **Scalability:** The dashboard will become unusable with large datasets.
*   **Inconsistency:** Mobile app (if built) would need to duplicate this logic.

## 5. Recommendations

### 1. Move Logic to Backend
*   Create `MaintenanceAlertService` in Java.
*   Implement `@Scheduled(cron = "0 0 8 * * *")` (Daily at 8 AM).
*   Query database: `SELECT * FROM maintenance_records WHERE scheduled_date <= TODAY AND status != 'COMPLETED'`.

### 2. Implement Notifications
*   Integrate an Email/SMS provider.
*   Send a daily summary to the Fleet Manager.

### 3. Optimize API
*   Create endpoint `GET /api/v1/maintenance/alerts` that returns *only* the alerts, paginated.

## Summary
The current implementation is a "Dashboard Widget", not an "Alerting System".
